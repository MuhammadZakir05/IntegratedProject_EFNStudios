<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div id="app-frame">
        <div id="app-content">
            <div class="header"><span>Dashboard</span><i class="fas fa-shield-alt" style="color:#3b82f6;"></i></div>
            
            <div class="card" style="background:#1a1a1a; display:flex; gap:20px;">
                <div style="flex:1; text-align:center;">
                    <span style="color:#888; font-size:0.8rem;">Balance</span>
                    <div id="bal" style="font-size:1.5rem; font-weight:bold; color:#22c55e;">...</div>
                </div>
                <div style="flex:1; text-align:center;">
                    <span style="color:#888; font-size:0.8rem;">Lost</span>
                    <div id="lost" style="font-size:1.5rem; font-weight:bold; color:#ef4444;">...</div>
                </div>
            </div>

            <a href="simulation.html" class="card" style="display:flex; align-items:center; gap:15px; text-decoration:none; color:white;">
                <div style="width:50px; height:50px; background:#3b82f6; border-radius:12px; display:flex; align-items:center; justify-content:center;"><i class="fas fa-play"></i></div>
                <div><b>Start</b><br><span style="color:#888; font-size:0.8rem;">Simulation</span></div>
            </a>

            <a href="scampedia.html" class="card" style="display:flex; align-items:center; gap:15px; text-decoration:none; color:white;">
                <div style="width:50px; height:50px; background:#d946ef; border-radius:12px; display:flex; align-items:center; justify-content:center;"><i class="fas fa-book"></i></div>
                <div><b>Scampedia</b><br><span style="color:#888; font-size:0.8rem;">Learn</span></div>
            </a>

            <h3>History</h3>
            <div id="history"></div>
        </div>
        <div class="nav-bar">
            <a href="home.html" class="nav-item active"><i class="fas fa-home"></i><span>Home</span></a>
            <a href="simulation.html" class="nav-item"><i class="fas fa-gamepad"></i><span>Sim</span></a>
            <a href="profile.html" class="nav-item"><i class="fas fa-user"></i><span>Profile</span></a>
        </div>
    </div>
    <script src="db.js"></script>
    <script>
        async function load() {
            let u = await DB.getUser();
            if(u) {
                document.getElementById('bal').innerText = `$${u.balance}`;
                document.getElementById('lost').innerText = `-$${u.startBalance - u.balance}`;
                let hDiv = document.getElementById('history');
                if(u.history.length === 0) hDiv.innerHTML = "<p style='color:#666'>No activity.</p>";
                u.history.reverse().forEach(h => {
                    let col = h.status==='failed'?'#ef4444':'#22c55e';
                    hDiv.innerHTML += `<div class="card" style="padding:15px; border-left:4px solid ${col}; display:flex; justify-content:space-between;"><span>${h.levelId}</span><span style="color:${col}">${h.status}</span></div>`;
                });
            }
        }
        load();
    </script>
</body>
</html>